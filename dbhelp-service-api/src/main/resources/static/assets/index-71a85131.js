import{ai as J,C as i,o as _,c as E,a as g,b as V,w as f,aT as C,aU as A,t as y,d as D,q as B,bo as I,P as U,E as $}from"./index-44918872.js";import{c as q,d as P,b as R,E as W,a as z}from"./select-166f790f.js";import"./checkbox-3e4f07b9.js";const G={id:"container"},Q={class:"topDiv"},X={class:"content"},Y=["innerHTML"],ae={__name:"index",setup(Z){let d="tpl_json_file_key",w="tpl_user_select_key";J(()=>{let e=localStorage.getItem(d);e&&S(e)});const k=i(null),O=i(null),T=i(null),b=i([{label:"选择数据-0",value:0}]),u=i(null),v=i([]),j=i(null),K=()=>{const e=new FileReader;e.onload=l=>{localStorage.removeItem(d);let t=l.target.result;localStorage.setItem(d,t),S(t),x()},e.readAsText(j.value.files[0])},S=e=>{let l=JSON.parse(e);k.value=l.tpl_data,O.value=l.table_column,T.value=l.appNameKey;let t=localStorage.getItem(w),n=!1;b.value=[{label:"选择数据-0",value:0}];for(let o in k.value)b.value.push({label:o,value:o}),t&&o==t&&(n=!0);n&&t&&(u.value=t,x())},x=()=>{let e=[];if(u.value==0){v.value=e;return}var l=k.value[u.value];let t=1;for(let n of l){let o={index:t,appName:n};for(let a of O.value){let N=T.value||"appName",h=a.url.replace(N,n),c="";a.key.indexOf("dev")>-1?c="a_dev":a.key.indexOf("test")>-1?c="a_test":a.key.indexOf("pre")>-1?c="a_pre":a.key.indexOf("prod")>-1&&(c="a_prod");let s="链接";if(a.key.indexOf("_")>-1){let m=a.key.split("_");m.length>1&&(s=m[1])}let p=`<a href="${h}" class="${c}" target='_blank'>${s}</a>`;o[a.key+"_url"]=p}e.push(o),t++}v.value=e},L=()=>{localStorage.setItem(w,u.value),x()},r=i(null),M=()=>{if(!r.value){I.warning("需要输入服务名");return}if(r.value=r.value.trim(),!r.value){I.warning("需要输入服务名");return}let e=localStorage.getItem(d);if(e){let l=JSON.parse(e),n=l.tpl_data[u.value],o=n.includes(r.value);for(let a of n)if(a==r.value){o=!0;break}o?I.success("服务名已存在"):(n.push(r.value),localStorage.setItem(d,JSON.stringify(l)),e=localStorage.getItem(d),S(e))}},F=e=>e==="index"?80:e==="appName"?200:150;return(e,l)=>{const t=q,n=P,o=U,a=$,N=R,h=W,c=z;return _(),E("div",G,[g("div",Q,[V(N,null,{default:f(()=>[g("input",{type:"file",ref_key:"fileInput",ref:j,onChange:K,accept:".json"},null,544),V(n,{modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=s=>u.value=s),filterable:"",onChange:L,placeholder:"选择版本"},{default:f(()=>[(_(!0),E(C,null,A(b.value,s=>(_(),y(t,{key:s.value,label:s.label,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),D("     "),u.value?(_(),y(o,{key:0,modelValue:r.value,"onUpdate:modelValue":l[1]||(l[1]=s=>r.value=s),placeholder:"服务名称"},null,8,["modelValue"])):B("",!0),u.value?(_(),y(a,{key:1,onClick:M},{default:f(()=>[D("临时添加服务")]),_:1})):B("",!0)]),_:1})]),g("div",X,[V(c,{border:"",data:v.value,"row-key":"index"},{default:f(()=>[(_(!0),E(C,null,A(v.value[0],(s,p,m)=>(_(),y(h,{key:m,label:p,width:F(p)},{default:f(H=>[g("span",{innerHTML:H.row[p]},null,8,Y)]),_:2},1032,["label","width"]))),128))]),_:1},8,["data"])])])}}};export{ae as default};
