import{ak as J,z as i,o as _,c as E,a as g,b as V,w as f,aV as C,aW as A,t as k,d as B,q as D,B as I,R as $,E as R}from"./index-220568ec.js";import{b as U,c as W,E as q,a as z}from"./select-ddc6a001.js";import"./checkbox-c5288fc2.js";import{E as G}from"./space-1924bf5e.js";const P={id:"container"},Q={class:"topDiv"},X={class:"content"},Y=["innerHTML"],ne={__name:"index",setup(Z){let d="tpl_json_file_key",w="tpl_user_select_key";J(()=>{let e=localStorage.getItem(d);e&&S(e)});const y=i(null),O=i(null),j=i(null),b=i([{label:"选择数据-0",value:0}]),u=i(null),m=i([]),T=i(null),K=()=>{const e=new FileReader;e.onload=l=>{localStorage.removeItem(d);let t=l.target.result;localStorage.setItem(d,t),S(t),x()},e.readAsText(T.value.files[0])},S=e=>{let l=JSON.parse(e);y.value=l.tpl_data,O.value=l.table_column,j.value=l.appNameKey;let t=localStorage.getItem(w),n=!1;b.value=[{label:"选择数据-0",value:0}];for(let o in y.value)b.value.push({label:o,value:o}),t&&o==t&&(n=!0);n&&t&&(u.value=t,x())},x=()=>{let e=[];if(u.value==0){m.value=e;return}var l=y.value[u.value];let t=1;for(let n of l){let o={index:t,appName:n};for(let a of O.value){let N=j.value||"appName",h=a.url.replace(N,n),c="";a.key.indexOf("dev")>-1?c="a_dev":a.key.indexOf("test")>-1?c="a_test":a.key.indexOf("pre")>-1?c="a_pre":a.key.indexOf("prod")>-1&&(c="a_prod");let s="链接";if(a.key.indexOf("_")>-1){let v=a.key.split("_");v.length>1&&(s=v[1])}let p=`<a href="${h}" class="${c}" target='_blank'>${s}</a>`;o[a.key+"_url"]=p}e.push(o),t++}m.value=e},L=()=>{localStorage.setItem(w,u.value),x()},r=i(null),M=()=>{if(!r.value){I.warning("需要输入服务名");return}if(r.value=r.value.trim(),!r.value){I.warning("需要输入服务名");return}let e=localStorage.getItem(d);if(e){let l=JSON.parse(e),n=l.tpl_data[u.value],o=n.includes(r.value);for(let a of n)if(a==r.value){o=!0;break}o?I.success("服务名已存在"):(n.push(r.value),localStorage.setItem(d,JSON.stringify(l)),e=localStorage.getItem(d),S(e))}},F=e=>e==="index"?80:e==="appName"?200:150;return(e,l)=>{const t=U,n=W,o=$,a=R,N=G,h=q,c=z;return _(),E("div",P,[g("div",Q,[V(N,null,{default:f(()=>[g("input",{type:"file",ref_key:"fileInput",ref:T,onChange:K,accept:".json"},null,544),V(n,{modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=s=>u.value=s),filterable:"",onChange:L,placeholder:"选择版本"},{default:f(()=>[(_(!0),E(C,null,A(b.value,s=>(_(),k(t,{key:s.value,label:s.label,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),B("     "),u.value?(_(),k(o,{key:0,modelValue:r.value,"onUpdate:modelValue":l[1]||(l[1]=s=>r.value=s),placeholder:"服务名称"},null,8,["modelValue"])):D("",!0),u.value?(_(),k(a,{key:1,onClick:M},{default:f(()=>[B("临时添加服务")]),_:1})):D("",!0)]),_:1})]),g("div",X,[V(c,{border:"",data:m.value,"row-key":"index"},{default:f(()=>[(_(!0),E(C,null,A(m.value[0],(s,p,v)=>(_(),k(h,{key:v,label:p,width:F(p)},{default:f(H=>[g("span",{innerHTML:H.row[p]},null,8,Y)]),_:2},1032,["label","width"]))),128))]),_:1},8,["data"])])])}}};export{ne as default};
