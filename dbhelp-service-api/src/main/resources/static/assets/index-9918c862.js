import{ak as J,z as c,o as _,c as V,a as g,b as I,w as m,aV as C,aW as A,t as k,d as B,q as D,B as w,R as $,E as R}from"./index-1febee11.js";import{b as U,c as W,E as q,a as z}from"./select-818650d1.js";import"./checkbox-9021b334.js";import{E as G}from"./space-b21730da.js";const P={id:"container"},Q={class:"topDiv"},X={class:"content"},Y=["innerHTML"],ne={__name:"index",setup(Z){let d="tpl_json_file_key",y="tpl_user_select_key";J(()=>{let e=localStorage.getItem(d);e&&x(e)});const b=c(null),O=c(null),j=c(null),S=c([{label:"选择数据-0",value:0}]),r=c(null),f=c([]),T=c(null),K=()=>{const e=new FileReader;e.onload=l=>{localStorage.removeItem(d);let t=l.target.result;localStorage.setItem(d,t),x(t),r.value="",localStorage.removeItem(y),N()},e.readAsText(T.value.files[0])},x=e=>{let l=JSON.parse(e);b.value=l.tpl_data,O.value=l.table_column,j.value=l.appNameKey;let t=localStorage.getItem(y),n=!1;S.value=[{label:"选择数据-0",value:0}];for(let o in b.value)S.value.push({label:o,value:o}),t&&o==t&&(n=!0);n&&t&&(r.value=t,N())},N=()=>{let e=[];if(r.value==0){f.value=e;return}var l=b.value[r.value];let t=1;for(let n of l){let o={index:t,appName:n};for(let a of O.value){let h=j.value||"appName",E=a.url.replace(h,n),i="";a.key.indexOf("dev")>-1?i="a_dev":a.key.indexOf("test")>-1?i="a_test":a.key.indexOf("pre")>-1?i="a_pre":a.key.indexOf("prod")>-1&&(i="a_prod");let s="链接";if(a.key.indexOf("_")>-1){let v=a.key.split("_");v.length>1&&(s=v[1])}let p=`<a href="${E}" class="${i}" target='_blank'>${s}</a>`;o[a.key+"_url"]=p}e.push(o),t++}f.value=e},L=()=>{localStorage.setItem(y,r.value),N()},u=c(null),M=()=>{if(!u.value){w.warning("需要输入服务名");return}if(u.value=u.value.trim(),!u.value){w.warning("需要输入服务名");return}let e=localStorage.getItem(d);if(e){let l=JSON.parse(e),n=l.tpl_data[r.value],o=n.includes(u.value);for(let a of n)if(a==u.value){o=!0;break}o?w.success("服务名已存在"):(n.push(u.value),localStorage.setItem(d,JSON.stringify(l)),e=localStorage.getItem(d),x(e))}},F=e=>e==="index"?80:e==="appName"?200:150;return(e,l)=>{const t=U,n=W,o=$,a=R,h=G,E=q,i=z;return _(),V("div",P,[g("div",Q,[I(h,null,{default:m(()=>[g("input",{type:"file",ref_key:"fileInput",ref:T,onChange:K,accept:".json"},null,544),I(n,{modelValue:r.value,"onUpdate:modelValue":l[0]||(l[0]=s=>r.value=s),filterable:"",onChange:L,placeholder:"选择版本"},{default:m(()=>[(_(!0),V(C,null,A(S.value,s=>(_(),k(t,{key:s.value,label:s.label,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),B("     "),r.value?(_(),k(o,{key:0,modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=s=>u.value=s),placeholder:"服务名称"},null,8,["modelValue"])):D("",!0),r.value?(_(),k(a,{key:1,onClick:M},{default:m(()=>[B("临时添加服务")]),_:1})):D("",!0)]),_:1})]),g("div",X,[I(i,{border:"",data:f.value,"row-key":"index"},{default:m(()=>[(_(!0),V(C,null,A(f.value[0],(s,p,v)=>(_(),k(E,{key:v,label:p,width:F(p)},{default:m(H=>[g("span",{innerHTML:H.row[p]},null,8,Y)]),_:2},1032,["label","width"]))),128))]),_:1},8,["data"])])])}}};export{ne as default};
